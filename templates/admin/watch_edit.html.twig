{% extends 'admin/base.html.twig' %}

{% block title %}Modifier la montre{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('styles/watchEditAdmin.css') }}">
{% endblock %}

{% block body %}
    <div class="edit-container">
        <div class="edit-header">
            <h1>Modifier la montre</h1>
            <a href="{{ path('admin_watches') }}" class="back-link">
                <i class="fas fa-arrow-left"></i> Retour à la liste
            </a>
        </div>

        {% for message in app.flashes('success') %}
            <div class="alert alert-success">
                {{ message }}
            </div>
        {% endfor %}

        {{ form_start(form, {'attr': {'class': 'edit-form'}}) }}
            <div class="form-group">
                {{ form_label(form.name, 'Nom de la montre') }}
                {{ form_widget(form.name, {'attr': {'class': 'form-control'}}) }}
                {{ form_errors(form.name, {'attr': {'class': 'form-error'}}) }}
            </div>

            <div class="form-group">
                {{ form_label(form.price, 'Prix') }}
                {{ form_widget(form.price, {'attr': {'class': 'form-control'}}) }}
                {{ form_errors(form.price, {'attr': {'class': 'form-error'}}) }}
            </div>

            {% if form.state is defined %}
                <div class="form-group">
                    {{ form_label(form.state, 'État') }}
                    {{ form_widget(form.state, {'attr': {'class': 'form-control'}}) }}
                    {{ form_errors(form.state, {'attr': {'class': 'form-error'}}) }}
                </div>
            {% endif %}

            <div class="form-group">
                {{ form_label(form.description, 'Description') }}
                {{ form_widget(form.description, {'attr': {'class': 'form-control'}}) }}
                {{ form_errors(form.description, {'attr': {'class': 'form-error'}}) }}
            </div>

            {% if watch.picture %}
                <div class="preview-container">
                    <label>Image actuelle</label>
                    {% if watch.author %}
                        {# Image pour les montres de particuliers #}
                        <img src="{{ asset('uploads/watch_pictures/' ~ watch.picture) }}" alt="{{ watch.name }}" class="preview-image">
                    {% else %}
                        {# Image pour les montres de la boutique depuis l'API #}
                        <img src="{{ watch.picture }}" alt="{{ watch.name }}" class="preview-image">
                    {% endif %}
                </div>
            {% endif %}

            <div class="form-group">
                {{ form_label(form.picture, 'Nouvelle image') }}
                {{ form_widget(form.picture, {'attr': {'class': 'form-control'}}) }}
                {{ form_errors(form.picture, {'attr': {'class': 'form-error'}}) }}
            </div>

            <div class="form-actions">
                <button type="submit" class="btn-submit">
                    <i class="fas fa-save"></i> Enregistrer les modifications
                </button>
                <a href="{{ path('admin_watches') }}" class="btn-submit btn-cancel">
                    <i class="fas fa-times"></i> Annuler
                </a>
            </div>
        {{ form_end(form) }}
    </div>
{% endblock %} 